/*! by da宗熊 MIT v1.0.3 update:2018/1/9 git:https://github.com/linfenpan/filter-select */
!function(e,t,n){e[t]=n(e)}(window,"FilterSelect",function(e){function t(){}function n(e,t,n){var i=e.getElementsByTagName(t);return n===d?i:i[n]}function i(e,t,n){return n===d?e.getAttribute(t):void e.setAttribute(t,n)}function a(e,t){if("string"==typeof t)return e.style[t];var n=t;for(var i in n)n.hasOwnProperty(i)&&(e.style[i]=n[i])}function l(e,t){e.className=e.className.replace(new RegExp("\\s*\\b"+t+"\\b","g"),"")}function o(e,t){return new RegExp("\\b"+t+"\\b").test(e.className)}function u(e,t){o(e,t)||(e.className+=" "+t)}function s(e,t){for(var n=0,i=e.length;n<i;n++)t.call(e,e[n],n)}function f(){for(var e=[].slice.call(arguments,0),t=e[0],n=1,i=e.length;n<i;n++){var a=e[n];for(var l in a)a.hasOwnProperty(l)&&(t[l]=a[l])}return t}function r(e){return e.replace(/^\s*|\s*$/g,"")}function c(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function p(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function v(e,i){var a=this;a.$root=e,i=a.options=f({data:function(e,t){t([])},callbackSelect:t,callbackChange:t,callbackShow:t,callbackHide:t,clearAtFocus:!0,resetOnHide:!0,placeholder:"请选择",defaultValue:"",defaultText:"",selectFirst:!0,freeInput:!0,minIndex:-1},i||{}),i.freeInput&&(i.defaultValue=i.defaultText),e.innerHTML=['<div class="m-placeholder" style="display:none;"></div>','<input type="text" class="m-input" autocomplete="off" disableautocomplete value="" />','<input type="hidden" class="m-input-hidden" autocomplete="off" disableautocomplete value="" />','<span class="m-input-ico" style="display:none;"></span>','<ul class="m-list" style="display:none;"></ul>'].join(""),u(e,"m-input-select"),a.$input=n(e,"input",0),a.$value=n(e,"input",1),a.$tip=n(e,"div",0),a.$ico=n(e,"span",0),a.$ul=n(e,"ul",0),a._f3=i.minIndex,a._f4=i.defaultText,a._f5=i.defaultValue,a._f6()}function h(e,t){var n=this;n.$select=e,n.options=f({watchSelect:!0,callbackSelect:function(){}},t||{}),this._f6()}var d=void 0,_="m-list-item-active";return v.prototype={_f6:function(){var e=this;e.reset(),e._f7()},reset:function(){var e=this;e._f8=0,e.isShow=!1,e.setPlaceholder(e.options.placeholder),e._f9(),a(e.$ul,{display:"none"});var t=e.options,n=t.defaultValue;n&&e.setValue(n)},setPlaceholder:function(e){this.$tip.innerHTML=e},_f10:function(){a(this.$tip,{display:"none"})},_f9:function(){a(this.$tip,{display:"block"})},_f7:function(){function e(){return!n.isDisabled()}function t(t,i){if((!t.propertyName||"value"==t.propertyName.toLowerCase())&&e()){var l=r(a.value);l?n._f10():n._f9(),n._f13(l),n._f14(),n.isShow||n.show()}}var n=this,i=n.options,a=n.$input;c(n.$ul,"click",function(e){var t=e.srcElement||e.target,i=t.tagName.toLowerCase();"li"==i&&(n._f11(t),n.hide())}),c(n.$ico,"click",function(){e()&&(n.isShow?n.hide():(a.focus(),n.show()))}),c(a,"focus",function(l){e()&&(i.clearAtFocus&&(a.value=""),n.show(),t.call(this,l))}),c(a,"keydown",function(t){if(e()){var a=!1,l=!1;switch(t.keyCode){case 38:n.prev(),a=!0;break;case 40:n.next(),a=!0;break;case 13:n._f11(n.$lis[n._f12()]),n.hide(),l=!0}return a&&i.callbackChange(n._f8),a||l?(t.preventDefault?t.preventDefault():(t||window.event).returnValue=!1,!1):void 0}}),c(a,"input",t),setTimeout(function(){c(a,"propertychange",t)},200)},_f13:function(e){var t=this,i=t.options,a=i.freeInput,l=[];i.data.call(this,e,function(e){s(e,function(e){l.push('<li class="m-list-item" data-value="'+(a?e.value:e.id)+'">'+e.value+"</li>")});var i=t.$ul;i.innerHTML=l.join(""),t.$lis=n(i,"li"),t.length=t.$lis.length})},_f14:function(e){var t=this;e=e||t._f15(),t.options.selectFirst&&(e=e<0?0:e),t._f8=e;var n=t.$lis[t._f8];n&&(u(n,_),t._f16())},_f16:function(){var e=this,t=e.$ul,n=e.$lis,i=e._f12();t.scrollTop=i>=0&&n[0]?n[0].clientHeight*i:0},_f17:function(e){var t=this,n=t.$lis,i=n.length,a=t._f3;e<=a?e=a:e>=i&&(e=i-1);var o=t._f12();o>=0&&l(n[o],_);var s=n[e];s&&(u(s,_),t._f16()),t._f8=e},_f11:function(e){var t,n,a=this;e?(t=e.innerHTML,n=i(e,"data-value")):n=a.options.freeInput?a.$input.value:a.$value.value,a.setValue(n)},_f12:function(){for(var e=this,t=-1,n=0;n<e.length;n++){var i=e.$lis[n];if(o(i,_))return n}return t},_f15:function(){for(var e=this,t=-1,n=e.getValue(),l=0;l<e.length;l++){var o=e.$lis[l];if(n==i(o,"data-value")&&"none"!=a(o,"display"))return l}return t},next:function(){return this._f17(this._f8+1)},prev:function(){return this._f17(this._f8-1)},hide:function(){var e=this;a(e.$ul,{display:"none"}),e._f10(),e.options.resetOnHide&&e.setValue(e.$value.value),e._f18(),e._f19&&e._f19(),e.isShow&&e.options.callbackHide.call(e),e.isShow=!1},show:function(e){var t=this;a(t.$ul,{display:"block"}),t._f20(),!t.isShow&&t.options.callbackShow.call(t),t.isShow=!0},getValue:function(){return this.$value.value},setValue:function(e){var t=this;if(t.$value.value=e,e&&t._f10(),t._f13(""),0==t.length&&!t.options.freeInput||t.options.freeInput&&""===e){var n=t.$tip.innerHTML;t.options.freeInput&&""===e&&(t.$value.value=n),t._f21(n)}else{if(t.$lis){var a=t.$lis[t._f12()];a&&l(a,_)}for(var o=!1,s=0,f=t.length;s<f;s++){var c=t.$lis[s],p=i(c,"data-value");if(p==e){u(c,_),t._f21(r(c.innerHTML)),o=!0;break}}o||t._f21(e)}t._f5!=e&&t._f18()},_f21:function(e){var t=this,n=t.$input,i=t.options.placeholder;e===i||e&&(i=e),n.value=e,t.setPlaceholder(i),e?t._f10():t._f9()},setDisabled:function(e){this.$input.disabled=e},isDisabled:function(){var e=this.$input;return e.disabled||e.readOnly},_f20:function(){function e(){p(l,a,t)}function t(t){if(!i.$ul)return e();var n=t.srcElement||t.target;"li"===n.tagName.toLowerCase()&&(n=n.parentNode),n!=i.$input&&n!=i.$ico&&n!=i.$ul&&(i.hide(),e())}function n(){e(),c(l,a,t)}var i=this,a="mouseup",l=document.getElementsByTagName("body")[0];i._f19=e,i._f20=n,n()},_f18:function(){var e=this,t=e.getValue();e._f5!==t&&(e._f5=t,e.options.callbackSelect(t,r(e.$tip.innerHTML)))}},h.prototype={_f6:function(){var e=this;e.update()},update:function(){var e,t,i=this,a=i.$select,l=n(a,"option"),o=[];s(l,function(n){var i=r(n.innerHTML),a=n.value;a=a||!n.outerHTML||/\svalue=/i.test(n.outerHTML)?a:i,o.push({id:a,value:i}),n.selected&&(e=a,t=i)}),i._f23=o,i._f24(e||"",t||"")},_f24:function(e,t){var n=this,i=n._f25;if(!i){var l=n.$root=document.createElement("div"),o=n.$select;o.parentNode.insertBefore(l,o),u(l,"m-inline-select");var s=n.options,r=function(e,t){o.value=e},c=s.callbackSelect;s.callbackSelect=function(e,t){r.call(this,e,t),c.call(this,e,t)},n._f25=i=new v(l,f({data:s.data||function(e,t){for(var i=[],a=n._f23,l=0,o=a.length;l<o;l++){var u=a[l];u.value.indexOf(e)>=0&&i.push(u)}t(i)},defaultText:t,defaultValue:e,placeholder:s.placeholder||t,freeInput:!1,selectFirst:!0,clearAtFocus:!0,minIndex:0},s)),a(i.$ico,{display:"block"}),a(o,{display:"none"}),s.watchSelect&&n._f26()}},_f26:function(){var e=this;c(e.$select,"change",function(){e.setValue(this.value)})},getValue:function(){return this._f25.getValue()},setValue:function(e){this._f25.setValue(e)},show:function(){this._f25.show()},hide:function(){this._f25.hide()}},h});